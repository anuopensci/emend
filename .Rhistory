library(emend)
chat <- ellmer::chat_ollama(model = "llama3.1:8b", seed = 0, echo = "none")
x <- c("16/02/1997", "20 November 2024", "24 Mar 2022", "2000-01-01", "Jason",
"Dec 25, 2030", "11/05/2024", "March 10, 1999")
emend_clean_date(x, chat = chat)
chat <- ellmer::chat_ollama(model = "llama3.1:8b", seed = 0)
x <- c("16/02/1997", "20 November 2024", "24 Mar 2022", "2000-01-01", "Jason",
"Dec 25, 2030", "11/05/2024", "March 10, 1999")
emend_clean_date(x, chat = chat)
emend_clean_date <- function(dates_vector, chat = NULL) {
if (!is.character(dates_vector)) {rlang::abort("Input must be a character vector.")}
if (is.null(chat)) {rlang::abort("Please provide the chat environment.")}
chat$set_system_prompt(paste0(
"You are an expert in data cleaning and standardization. ",
"Your task is to identify and parse dates in various formats, then convert them into the standard 'YYYY-MM-DD' format. ",
"If a string is not a recognizable date, return 'INVALID'. ",
"Always ensure correct parsing, considering different date formats such as 'DD/MM/YYYY', 'Month DD, YYYY', 'YYYY-MM-DD', 'DD Mon YYYY', and similar variations. ",
"Output result only."
))
chat$clone()
chat$set_turns(list())
converted <- lapply(dates_vector, function(x) {
response <- chat$chat(paste0(
"Standardize this date: ", x
))
return(response)
})
new_dates <- as.Date(unlist(converted), format = "%Y-%m-%d")
return(new_dates)
}
x <- c("16/02/1997", "20 November 2024", "24 Mar 2022", "2000-01-01", "Jason",
"Dec 25, 2030", "11/05/2024", "March 10, 1999")
emend_clean_date(x, chat = chat)
?devtools::check()
setwd("~/GitHub/emend")
install.packages("pkgdown")
quit()
